# RudimentaryRTOS

This project is a **minimal real-time operating system (RTOS)** built entirely from scratch as part of my personal learning journey. It demonstrates the core concepts of task switching and basic kernel functionality using an STM32F041 Nucleo board.

## Overview

This RTOS includes:

- Cooperative round-robin scheduler
- Context switching using SysTick timer
- Basic thread control blocks (TCBs)
- Manual stack initialization for each thread
- Written entirely in C with inline ARM assembly

It is intentionally kept simple to understand how an RTOS works under the hood without relying on external libraries.

## Motivation

The goal is to understand the **bare-metal workings** of an RTOS, including:

- How context switching works on ARM Cortex-M0+
- How to use SysTick for periodic interrupts
- How to store and restore CPU state during task switches
- How a simple scheduler manages multiple tasks

This was tested and debugged directly on hardware, not just in simulation.

## Hardware Used

- [STM32F041 Nucleo Board](https://www.st.com/en/evaluation-tools/nucleo-f041rb.html)
- Optional: ST-Link for debugging
- IDE: STM32CubeIDE or any ARM toolchain with Makefile support

## Project Structure
/src
‚îú‚îÄ‚îÄ tesOSkernel.c # Kernel functions: osInit, osAddThread, osLaunch
‚îú‚îÄ‚îÄ uart.c # uart configuration (without HAL) to print text to serial terminal
‚îú‚îÄ‚îÄ main.c # Example tasks and main loop
‚îú‚îÄ‚îÄ syscalls.c # automatically generated by STM32CubeIDE
‚îú‚îÄ‚îÄ sysmem.c # automatically generated by STM32CubeIDE

/inc
‚îú‚îÄ‚îÄ oskernel.h
‚îú‚îÄ‚îÄ uart.h

## Features

- Manual thread stack setup
- Context switch using `push/pop` of CPU registers
- Round-robin scheduler (`SchedulerRR`)
- Minimal use of assembly to interact directly with hardware

## How Context Switching Works

1. Each task is assigned its own stack
2. SysTick interrupt triggers context switch
3. `SysTick_Handler()` saves current task state (registers, SP) and acts as the Scheduler picking the next task
4. New task state is restored and execution continues

## How to Run

1. Clone this repository
2. Open in STM32CubeIDE (or use Makefile if preferred)
3. Flash to STM32F041 Nucleo board
4. serial terminal and debug output for task switching (Task0_Profiler, Task1_Profiler, Task2_Profiler being incremented at almost the same time)

## Example Tasks

The example in `main.c` includes:

- Three tasks (incrementing 3 Task Profilers and printing 3 different messages)
- Demonstrates context switching and cooperative multitasking

## üìù Notes

- This is a **learning project** ‚Äî not intended for production.
- Designed specifically for ARM Cortex-M4 architecture.


